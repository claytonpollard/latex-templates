% Grid Background
%%%`\GridOn' to enable on page.

\usepackage[pages=some]{background}
\newcommand{\GridOn}{\BgThispage}
\def\Step{5mm}
\backgroundsetup{
scale=1,
angle=0,
contents={
\begin{tikzpicture}[remember picture,overlay]
\draw[step=\Step,help lines,dashed]
  (current page.north west) grid  (current page.south east);
\draw[step=2*\Step,help lines]
  (current page.north west) grid  (current page.south east);
  \end{tikzpicture}
  }
}

% Cloze
%%% `\ShowClozetrue' to enable, `\ShowClozefalse' to disable
\newif\ifShowCloze
\ShowClozefalse
\newcommand{\Cloze}[1]{
    \ifShowCloze
        \dotuline{\parbox[b]{\widthof{\LARGE\textbf{#1}}}{ \vphantom{\vspace{1ex}} \centering %
        {\color{OrangeRed}  {\protect #1}} %
        }}
    \else
        \dotuline{\parbox[b]{\widthof{\LARGE\textbf{#1}}}{ \vphantom{\vspace{1ex}}\centering %
            \hfill
            }
        }
    \fi
}

% Boxes
\usepackage[most]{tcolorbox} % Required for boxes
	\tcbuselibrary{skins,breakable,xparse}
\usepackage{varwidth}

\newtcolorbox[auto counter]{definition}[1][]{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,colback=col1!20!white,fonttitle=\bfseries,coltitle=col1!50!black,colframe=col1!50!white,title=Definition~\thetcbcounter\quad#1\newline,attach title to upper,borderline west={2pt}{0pt}{col1!80!black},left=3mm}

\newtcolorbox[auto counter]{examplebox}[1][]{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,colback=col2!20!white,fonttitle=\bfseries,coltitle=col2!50!black,colframe=col2!50!white,title=Example~\thetcbcounter\quad#1\newline,attach title to upper,borderline west={2pt}{0pt}{col2!80!black},left=3mm}

\newtcolorbox{solutionbox}[1][height=4cm]{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,#1,colback=col2!80!white,fonttitle=\bfseries,coltitle=col2!50!black,colframe=col2!50!white,opacityback=.1,title=Solution\newline,attach title to upper,borderline west={2pt}{0pt}{col2!80!black},left=3mm,top=3mm,,borderline north={1pt}{0pt}{col2!80!black},before={\vspace{-5pt}}}

\newtcolorbox{note}{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,colback=col3!20!white,fonttitle=\normalfont\bfseries,coltitle=col3!50!black,colframe=col3!50!white,title=Note~,attach title to upper,borderline west={2pt}{0pt}{col3!80!black},left=3mm,fontupper=\itshape}

\newtcolorbox{important}{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,colback=col4!20!white,fonttitle=\bfseries,coltitle=col4!50!black,colframe=col4!50!white,title=Important Note\newline,attach title to upper,borderline west={2pt}{0pt}{col4!80!black},left=3mm}

\newtcolorbox{further}{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,colback=col5!20!white,fonttitle=\bfseries,coltitle=col5!50!black,colframe=col5!50!white,title=Further Exercises\newline,attach title to upper,borderline west={2pt}{0pt}{col5!80!black},left=3mm}

\newtcolorbox{outcome}{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,colback=col6!20!white,fonttitle=\bfseries,coltitle=col6!50!black,colframe=col6!50!white,title=Learning Outcome\newline,attach title to upper,borderline west={2pt}{0pt}{col6!80!black},left=3mm}

\newtcolorbox{law}[1][]{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,colback=col3!20!white,fonttitle=\bfseries,coltitle=col1!50!black,colframe=col1!50!white,title=#1~Law\newline,attach title to upper,borderline west={2pt}{0pt}{col1!80!black},borderline north={2pt}{0pt}{col1!80!black},left=3mm,top=3mm}

\newtcolorbox{theorem}[1][]{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,colback=col3!20!white,fonttitle=\bfseries,coltitle=col2!50!black,colframe=col2!50!white,title=#1~Theorem\newline,attach title to upper,borderline west={2pt}{0pt}{col2!80!black},borderline north={2pt}{0pt}{col2!80!black},left=3mm,top=3mm}

\newtcolorbox{resultbox}{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,colback=col3!20!white,fonttitle=\bfseries,coltitle=col4!50!black,colframe=col4!50!white,title=Result\newline,attach title to upper,borderline west={2pt}{0pt}{col4!80!black},borderline north={2pt}{0pt}{col4!80!black},left=3mm,top=3mm}

\renewtcolorbox{proof}[1][height=4cm]{standard jigsaw,enhanced,sharp corners,frame hidden,boxrule=0pt,breakable,#1,colback=col3!80!white,fonttitle=\bfseries,coltitle=col4!50!black,colframe=col3!50!white,opacityback=.1,title=Proof\newline,attach title to upper,borderline west={2pt}{0pt}{col4!80!black},left=3mm,top=3mm,borderline north={1pt}{0pt}{col4!80!black},before={\vspace{-5pt}}}

\usepackage{environ}

\NewEnviron{example}[2][height=4cm]{
  \begin{examplebox}[#2]
  \BODY
  \end{examplebox}
  \begin{solutionbox}[#1]
  \end{solutionbox}
}

\NewEnviron{result}[1][height=4cm]{
  \begin{resultbox}
  \BODY
  \end{resultbox}
  \begin{proof}[#1]
  \end{proof}
}